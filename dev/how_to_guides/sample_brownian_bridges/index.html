<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>How to sample Brownian bridges? · DiffusionDefinition.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DiffusionDefinition.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DiffusionDefinition.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/package_overview/">Get started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">User manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/defining_diffusions/">Defining diffusions</a></li><li><a class="tocitem" href="../../manual/drift_and_volatility/">Drift and volatility</a></li><li><a class="tocitem" href="../../manual/sampling/">Sampling trajectories</a></li><li><a class="tocitem" href="../../manual/functionals_of_paths/">Computing path-functionals</a></li><li><a class="tocitem" href="../../manual/load_diff/">Loading diffusions</a></li><li><a class="tocitem" href="../../manual/convenience_functions/">Utility functions</a></li><li><a class="tocitem" href="../../manual/buffers/">Buffers</a></li><li><a class="tocitem" href="../../manual/state_space/">State space restrictions</a></li><li><a class="tocitem" href="../../manual/reparameterization/">Reparameterizations</a></li><li><a class="tocitem" href="../../manual/conjugate_updates/">Conjugate updates</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">How to...</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>How to sample Brownian bridges?</a><ul class="internal"><li><a class="tocitem" href="#Approximate-bridges-1"><span>Approximate bridges</span></a></li><li><a class="tocitem" href="#Exact-bridges-1"><span>Exact bridges</span></a></li></ul></li><li><a class="tocitem" href="../sample_diffusion_bridges/">How to sample Diffusion bridges?</a></li><li><a class="tocitem" href="../sample_complex_valued/">How to sample complex-valued diffusions?</a></li><li><a class="tocitem" href="../customize_my_diffusion_plots/">How to customize plots of diffusion trajectories?</a></li><li><a class="tocitem" href="../expect_of_gradient/">How to compute expectation of gradients of functionals?</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/swinging_pendulum/">Defining a diffusion process for a swinging pendulum</a></li><li><a class="tocitem" href="../../tutorials/in_place_vs_out_of_place/">(TODO) In-place vs out-of-place methods</a></li><li><a class="tocitem" href="../../tutorials/diffusion_bridges/">Sampling of diffusion bridges</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Predefined Diffusions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../predefined_processes/lotka_volterra/">Lotka-Volterra system</a></li><li><a class="tocitem" href="../../predefined_processes/sine/">Sine diffusion</a></li><li><a class="tocitem" href="../../predefined_processes/sir/">SIR model</a></li><li><a class="tocitem" href="../../predefined_processes/lorenz63/">Lorenz63 system</a></li><li><a class="tocitem" href="../../predefined_processes/lorenz96/">Lorenz96 system</a></li><li><a class="tocitem" href="../../predefined_processes/favetto_samson/">Favetto-Samson model</a></li><li><a class="tocitem" href="../../predefined_processes/prokaryote/">Prokaryotic autoregulatory gene network</a></li><li><a class="tocitem" href="../../predefined_processes/fitzhugh_nagumo/">FitzHugh-Nagumo model</a></li><li><a class="tocitem" href="../../predefined_processes/jansen_rit/">Jansen-Rit model</a></li></ul></li><li><a class="tocitem" href="../../post_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to...</a></li><li class="is-active"><a href>How to sample Brownian bridges?</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>How to sample Brownian bridges?</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDiffusionBayes/DiffusionDefinition.jl/blob/master/docs/src/how_to_guides/sample_brownian_bridges.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="how_to_guides-1"><a class="docs-heading-anchor" href="#how_to_guides-1">How to sample Brownian bridges?</a><a class="docs-heading-anchor-permalink" href="#how_to_guides-1" title="Permalink"></a></h1><hr/><p>Brownian bridge is a Brownian motion conditioned to hit a pre-specified end-point.</p><h2 id="Approximate-bridges-1"><a class="docs-heading-anchor" href="#Approximate-bridges-1">Approximate bridges</a><a class="docs-heading-anchor-permalink" href="#Approximate-bridges-1" title="Permalink"></a></h2><hr/><p>One way to sample Brownian bridges relies on an unconditioned SDE that describes the dynamics of a Brownian bridge (conditioned to hit <span>$x_T\in\RR^d$</span>).</p><div>\[\dd X_t = \frac{x_T-X_t}{T-t}\dd t + \dd W_t,\qquad X_0=x_0\qquad t\in[0,T].\]</div><p>Define a diffusion with such a drift and then sample from it:</p><pre><code class="language-julia">using DiffusionDefinition, Plots
const DD = DiffusionDefinition

@diffusion_process BBApprox begin
    :auxiliary_info
    T --&gt; Float64
    xT --&gt; Float64
end

DD.b(t, x, P::BBApprox) = (P.xT - x)/(P.T-t)
DD.σ(t, x, P::BBApprox) = 1.0

DD.default_type(::BBApprox) = Float64
DD.default_wiener_type(::BBApprox) = Float64

xT, T = -0.5, 2.0
P = BBApprox(T, xT)
tt, x0 = 0.0:0.001:T, 0.5
X = rand(P, tt, x0)

plot_kwargs = (color=&quot;steelblue&quot;, label=&quot;&quot;)
p = plot(X; plot_kwargs...)
for i in 1:30
    plot!(p, rand(P, tt, x0); alpha=0.2, plot_kwargs...)
end
display(p)</code></pre><p><img src="../../assets/how_to/sample_bb/bb_approx.png" alt="bb_approx"/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Bridges above rely on the Euler–Maruyama scheme and are thus burdened with an approximation error. To sample Brownian bridges devoid of any errors (without sacrificing any performance) use the method below.</p></div></div><h2 id="Exact-bridges-1"><a class="docs-heading-anchor" href="#Exact-bridges-1">Exact bridges</a><a class="docs-heading-anchor-permalink" href="#Exact-bridges-1" title="Permalink"></a></h2><hr/><p>A preferred way of sampling Brownian bridges relies on a second identity that connects distributions of</p><ol><li><code>W</code>—a Brownian motion on <span>$[0,T]$</span> started from <span>$0$</span>, and</li><li><code>B</code>—a Brownian bridge on <span>$[0,T]$</span> connecting <span>$x_0$</span> and <span>$x_T$</span>:</li></ol><div>\[\left\{
    x_0 + W_t + \frac{t}{T}\left( x_T-x_0-W_T \right); t\in[0,T]
\right\} \overset{d}{=} B.\]</div><pre><code class="language-julia">B = trajectory(tt, Float64)
W = rand(Wiener(), tt, 0.0)
B.x .= x0 .+ W.x .+ tt./T.*(xT .- x0 .- W.x[end])

p = plot(B; plot_kwargs...)
for i in 1:30
    W = rand(Wiener(), tt, 0.0)
    B.x .= x0 .+ W.x .+ tt./T.*(xT .- x0 .- W.x[end])
    plot!(p, B; alpha=0.2, plot_kwargs...)
end
display(p)</code></pre><p><img src="../../assets/how_to/sample_bb/bb_exact.png" alt="bb_exact"/></p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Both method apply to sampling of multidimensional Brownian bridges as well!</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/conjugate_updates/">« Conjugate updates</a><a class="docs-footer-nextpage" href="../sample_diffusion_bridges/">How to sample Diffusion bridges? »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 8 June 2020 08:12">Monday 8 June 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
